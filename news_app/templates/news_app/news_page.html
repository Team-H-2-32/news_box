{% extends 'main/base.html' %}
{% block content %}
<!--body-->
<div class="container-fluid"  style="margin-top: 4%">
    <div class="row" style="padding: 20px 0 0 30px;">
        <div class="col-sm-2" style=" border-right: solid 1px;">
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='sports'>スポーツ</button>
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='business'>business</button>
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='technology'>technology</button>
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='health'>health</button>
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='entertainment'>entertainment</button>
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='science'>science</button>
            <button class="category_button hover_color_button categories" style="margin-bottom: 20px;" url-id='general'>general</button>
        </div>
        <div class="col-sm-6" style="margin-left: 10%; padding: 0; ">
            <p class="category_title" style="font-size: 56px; text-align: center;">スポーツ</p>
            <p class="category_title" style="font-size: 56px; text-align: center;">business</p>
            <p class="category_title" style="font-size: 56px; text-align: center;">technology</p>
            <p class="category_title" style="font-size: 56px; text-align: center;">health</p>
            <p class="category_title" style="font-size: 56px; text-align: center;">entertainment</p>
            <p class="category_title" style="font-size: 56px; text-align: center;">science</p>
            <p class="category_title" style="font-size: 56px; text-align: center;">general</p>
            <ul id="news-container" style="list-style: none;">


            </ul>
        </div>
        <div class="col-sm-4">

        </div>
    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const categories = document.querySelectorAll(".categories");

        categories.forEach((category) => {
            category.addEventListener("click", (e) => {
                e.preventDefault();

                const urlId = category.getAttribute("url-id");

                console.log(urlId);

                fetch(`news/${urlId}`)
                    .then((response) => response.json())
                    .then((data) => {

                        const news = data.news;

                        const newsContainer = document.getElementById("news-container"); // Changed getElementsById to getElementById

                        newsContainer.innerHTML = "";

                        news.forEach((newsObj) => {
                            const content = document.createElement("li");
                            content.innerHTML = `
                                <div class="row border_radius_news_item" style='margin-bottom: 30px;'>
                                    <div class="col-sm-3">
                                        <img src="${newsObj.photo}" alt="No photo" style="width: 90%; height: 60%; margin: 16% 0px 0 8%;">
                                    </div>
                                    <div class="col-sm-9">
                                        <h4><a href="${newsObj.url}"><b>${newsObj.title}</b></a></h4>
                                        <p>${newsObj.source}</p>
                                    </div>
                                </div>
                                `;
                            newsContainer.appendChild(content);
                        });
                    });
            });
        });
    });

    const $ = document.querySelector.bind(document)
    const $$ = document.querySelectorAll.bind(document)

    const tabs = $$('.category_button')
    const titles = $$('.category_title')

    tabs.forEach((tab, index) => {
        const title = titles[index]

        tab.onclick = function () {
            if (($('.category_button.active')) && ($('.category_title.active'))) {
                $('.category_button.active').classList.remove('active')
                $('.category_title.active').classList.remove('active')

                this.classList.add('active')
                title.classList.add('active')
            } else {
                this.classList.add('active')
                title.classList.add('active')
            }
        }
    })
</script>
{% endblock %}
